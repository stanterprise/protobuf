syntax = "proto3";

package testsystem.v1.events;

import "google/protobuf/timestamp.proto";
import "testsystem/v1/common/common.proto";
import "testsystem/v1/entities/test_case.proto";
import "testsystem/v1/entities/test_suite.proto";
import "google/protobuf/duration.proto";

option go_package = "github.com/stanterprise/proto-go/testsystem/v1/events";
option java_package = "com.stanterprise.testsystem.v1.events";
option java_multiple_files = true;

message TestBeginEventRequest {
  testsystem.v1.entities.TestCaseRun test_case = 1;
}

message TestEndEventRequest {
  testsystem.v1.entities.TestCaseRun test_case = 1;
}

message StepBeginEventRequest {
  testsystem.v1.entities.StepRun step = 1;
}

message StepEndEventRequest {
  testsystem.v1.entities.StepRun step = 1;
}

message TestFailureEventRequest {
  string test_id = 1;
  string failure_message = 2;
  string stack_trace = 3;
  google.protobuf.Timestamp timestamp = 4;
  repeated testsystem.v1.common.Attachment attachments = 5;
  string run_id = 6;
  string retry_index = 7;
}
message TestErrorEventRequest {
  string test_id = 1;
  string error_message = 2;
  string stack_trace = 3;
  google.protobuf.Timestamp timestamp = 4;
  repeated testsystem.v1.common.Attachment attachments = 5;
  string run_id = 6;
  string retry_index = 7;
}

message StdErrorEventRequest {
  string test_id = 1;
  string message = 2;
  google.protobuf.Timestamp timestamp = 3;
  string test_case_run_id = 4; // Reference to the specific test case run
  string run_id = 5;
}
message StdOutputEventRequest {
  string test_id = 1;
  string message = 2;
  google.protobuf.Timestamp timestamp = 3;
  string test_case_run_id = 4; // Reference to the specific test case run
  string run_id = 5;
}

message SuiteBeginEventRequest {
  testsystem.v1.entities.TestSuiteRun suite = 1;
}
message SuiteEndEventRequest {
  testsystem.v1.entities.TestSuiteRun suite = 1;
}

message HeartbeatEventRequest {
  string source_id = 1; // Identifier for the source sending the heartbeat
  google.protobuf.Timestamp timestamp = 2;
}

message ReportRunStartEventRequest {
  string run_id = 1;
  repeated testsystem.v1.entities.TestSuiteRun test_suites = 2;
  int32 total_tests = 3;
  string name = 4;
  map<string, string> metadata = 5;
}

message TestRunEndEventRequest {
  string run_id = 1;
  testsystem.v1.common.TestStatus final_status = 2;
  google.protobuf.Timestamp start_time = 3;
  google.protobuf.Duration duration = 4;
}