syntax = "proto3";

package testsystem.v1.entities;

import "testsystem/v1/common/common.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/duration.proto";

option go_package = "github.com/stanterprise/proto-go/testsystem/v1/entities";
option java_package = "com.stanterprise.testsystem.v1.entities";
option java_multiple_files = true;

message TestCaseRun {
    string id = 1; // Unique identifier for the test result
    string name = 2; // Name/title of the test case
    string description = 3; // Description of the test case
    string run_id = 4; // Identifier for the global test run this test belongs to
    string test_suite_run_id = 5; // Reference to the test suite run this test belongs to
    testsystem.v1.common.TestStatus status = 6; // Result status (e.g., "passed", "failed", "skipped")
    google.protobuf.Timestamp start_time = 7; // Start time of the test execution
    google.protobuf.Timestamp end_time = 8; // End time of the test execution
    google.protobuf.Duration duration = 9; // Duration of the test execution
    repeated testsystem.v1.common.Attachment attachments = 10; // Attachments related to the test result
    string error_message = 11; // Error message if the test failed
    string stack_trace = 12;  // Stack trace if applicable
    repeated string errors = 13; // List of error messages if any
    map<string, string> metadata = 14; // Additional metadata for the test result
    repeated string tags = 15; // Tags associated with the test case
    string location = 16; // Location in the code where the test is defined
    int32 retry_count = 17; // Total number of retry attempts allowed for this test
    int32 retry_index = 18; // Current retry attempt index (0 for first attempt)
    int32 timeout = 19; // Timeout in milliseconds for this test
}

message StepRun {
    string id = 1; // Unique identifier for the step result
    string run_id = 2; // Identifier for the global test run this step belongs to
    string test_case_run_id = 3; // Reference to the test case run this step belongs to
    string title = 4; // Title of the step
    string description = 5; // Description of the step
    google.protobuf.Timestamp start_time = 6; // Start time of the test execution
    google.protobuf.Duration duration = 7; // Estimated duration in seconds
    string type = 8; // Type of the step (e.g., "setup", "execution", "validation")
    map<string, string> metadata = 9; // Additional metadata for the step
    string parent_step_id = 10; // Reference to the parent step for nested steps, if any
    string worker_index = 11; // Identifier for the worker executing the step
    testsystem.v1.common.TestStatus status = 12; // Result status (e.g., "passed", "failed", "skipped")
    string error = 13; // Error message if the step failed
    repeated string errors = 14; // List of all error messages observed during step execution, if any
    string location = 15; // Location in the code where the step is defined
    string category = 16; // Category of step (e.g., "hook", "fixture", "test.step")
}
